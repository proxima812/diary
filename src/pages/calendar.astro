---
import Layout from "@/layouts/Layout.astro"

// –ù–∞–∑–≤–∞–Ω–∏—è –º–µ—Å—è—Ü–µ–≤
const monthNames = {
	january: "–Ø–Ω–≤–∞—Ä—å",
	february: "–§–µ–≤—Ä–∞–ª—å",
	march: "–ú–∞—Ä—Ç",
	april: "–ê–ø—Ä–µ–ª—å",
	may: "–ú–∞–π",
	june: "–ò—é–Ω—å",
	july: "–ò—é–ª—å",
	august: "–ê–≤–≥—É—Å—Ç",
	september: "–°–µ–Ω—Ç—è–±—Ä—å",
	october: "–û–∫—Ç—è–±—Ä—å",
	november: "–ù–æ—è–±—Ä—å",
	december: "–î–µ–∫–∞–±—Ä—å",
}

const holidays = {
	january: [1, 2, 7], // –ù–æ–≤—ã–π –≥–æ–¥, –†–æ–∂–¥–µ—Å—Ç–≤–æ (–≤ —Å—Ç—Ä–∞–Ω–∞—Ö, –≥–¥–µ –ø–æ –ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω–æ–º—É –∫–∞–ª–µ–Ω–¥–∞—Ä—é)
	february: [23], // –î–µ–Ω—å –∑–∞—â–∏—Ç–Ω–∏–∫–∞ –û—Ç–µ—á–µ—Å—Ç–≤–∞ / ‚Äú–ú—É–∂—Å–∫–æ–π –¥–µ–Ω—å‚Äù (–≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å—Ç—Ä–∞–Ω–∞—Ö)
	march: [8], // –ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π –∂–µ–Ω—Å–∫–∏–π –¥–µ–Ω—å
	may: [1, 9], // –î–µ–Ω—å —Ç—Ä—É–¥–∞, –î–µ–Ω—å –ü–æ–±–µ–¥—ã
	june: [12], // –î–µ–Ω—å –†–æ—Å—Å–∏–∏ / –ø—Ä–∞–∑–¥–Ω–∏–∫ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å—Ç—Ä–∞–Ω–∞—Ö)
	august: [30], // –î–µ–Ω—å –ö–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏–∏ / –¥–µ–Ω—å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å—Ç—Ä–∞–Ω–∞—Ö)
	october: [], // –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–∑–¥–Ω–∏–∫–∏
	november: [4], // –î–µ–Ω—å –Ω–∞—Ä–æ–¥–Ω–æ–≥–æ –µ–¥–∏–Ω—Å—Ç–≤–∞ (–≤ –†–æ—Å—Å–∏–∏)
	december: [25, 31], // –†–æ–∂–¥–µ—Å—Ç–≤–æ (–≥–¥–µ –æ—Ç–º–µ—á–∞—é—Ç 25-–≥–æ), –∫–∞–Ω—É–Ω –ù–æ–≤–æ–≥–æ –≥–æ–¥–∞
}

// –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π –≤ –º–µ—Å—è—Ü–µ
const daysInMonth = {
	january: 31,
	february: 28,
	march: 31,
	april: 30,
	may: 31,
	june: 30,
	july: 31,
	august: 31,
	september: 30,
	october: 31,
	november: 30,
	december: 31,
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å–º–µ—â–µ–Ω–∏—è –ø–µ—Ä–≤–æ–≥–æ –¥–Ω—è –º–µ—Å—è—Ü–∞ (0 = –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫)
function getFirstDayOffset(month) {
	const monthIndex = Object.keys(monthNames).indexOf(month)
	const date = new Date(2025, monthIndex, 1)
	let offset = date.getDay() // 0 = –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ, 1 = –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ ...
	return offset === 0 ? 6 : offset - 1 // —á—Ç–æ–±—ã –Ω–µ–¥–µ–ª—è –Ω–∞—á–∏–Ω–∞–ª–∞—Å—å —Å –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫–∞
}
---

<Layout title="–†–∞–∑–º—ã—à–ª–µ–Ω–∏—è –ê–ê: –∫–∞–ª–µ–Ω–¥–∞—Ä—å">
	<div class="flex flex-col gap-12">
		{
			Object.keys(monthNames).map(month => {
				const totalDays = daysInMonth[month]
				const firstDayOffset = getFirstDayOffset(month)
				const cells = []
				const totalCells = firstDayOffset + totalDays
				for (let i = 0; i < totalCells; i++) {
					if (i < firstDayOffset) {
						cells.push(null)
					} else {
						cells.push(i - firstDayOffset + 1)
					}
				}

				return (
					<section>
						<div class="flex items-center justify-between mb-3 px-1 sm:px-0">
							<h2 class="text-lg sm:text-xl font-semibold">üìÖ {monthNames[month]}</h2>
							<span class="text-xs sm:text-sm text-zinc-500">{totalDays} –¥–Ω–µ–π</span>
						</div>

						{/* —Å–µ—Ç–∫–∞ —Å –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å—é */}
						<div class="grid grid-cols-7 gap-1 sm:gap-1.5 justify-items-center">
							{/* –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏ */}
							{["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"].map(day => (
								<div class="text-center text-[10px] sm:text-xs text-zinc-500 font-medium mb-1">
									{day}
								</div>
							))}

							{/* —è—á–µ–π–∫–∏ –¥–Ω–µ–π */}
							{cells.map(day => {
								if (!day) {
									return <div class="w-[38px] h-[38px] sm:w-[70px] sm:h-[70px]" />
								}

								const isHoliday = holidays[month]?.includes(day)
								const dayStr = String(day).padStart(2, "0")
								const monthIndex = Object.keys(monthNames).indexOf(month) + 1
								const monthStr = String(monthIndex).padStart(2, "0")
								const slug = `daily_${dayStr}-${monthStr}`

								return (
									<a
										href={`/aa/${month}/${slug}`}
										class={`w-[38px] h-[38px] sm:w-[70px] sm:h-[70px] flex flex-col items-center justify-center rounded-xl border text-[13px] sm:text-sm transition-all select-none
											${
												isHoliday
													? "bg-purple-50 border-purple-200 text-purple-600 font-semibold "
													: "bg-white hover:bg-zinc-100 border-zinc-200 text-zinc-800"
											}`}
									>
										<span>{day}</span>
										{isHoliday && (
											<div class="mt-[2px] w-1 h-1 sm:w-1.5 sm:h-1.5 rounded-full bg-purple-400" />
										)}
									</a>
								)
							})}
						</div>
					</section>
				)
			})
		}
	</div>
</Layout>
