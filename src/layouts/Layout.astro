---
import Container from "@/components/Container.astro";
import Footer from "@/components/Footer.astro";
import Header from "@/components/Header.astro";
import PwaInstallBanner from "@/components/PwaInstallBanner.astro";
import SEO from "@/components/SEO.astro";
import "@/styles/tailwind.css";

interface Props {
	title: string;
	description: string;
	datePublished?: string;
	bodyStyle?: string;
	dateModified?: string;
	indexRobots?: string;
	type?: any;
	keywords?: string;
	ogImage?: any;
}

const {
	datePublished,
	bodyStyle,
	dateModified,
	indexRobots,
	title,
	type,
	description,
	ogImage,
	keywords,
} = Astro.props;

Astro.response.headers.set("Cache-Control", "public, max-age=3600");
---

<html lang="ru" class="scroll-smooth subpixel-antialiased">
	<head>
		<script is:inline>
			(() => {
				const key = "theme-preference";
				const saved = localStorage.getItem(key);
				const theme =
					saved || (window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light");
				document.documentElement.dataset.theme = theme;
			})();
		</script>
		<SEO
			title={title}
			description={description}
			indexRobots={indexRobots}
			ogImage={ogImage}
			type={type}
			keywords={keywords}
			datePublished={datePublished}
			dateModified={dateModified}
		/>
		<link rel="manifest" href="/manifest.webmanifest" />
		<meta name="theme-color" content="#0a0a0a" />
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="default" />
		<meta name="apple-mobile-web-app-title" content="Diary365" />
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap"
			rel="stylesheet"
		/>
		<script is:inline>
			if ("serviceWorker" in navigator) {
				window.addEventListener("load", () => {
					navigator.serviceWorker.register("/sw.js").catch(() => {});
				});
			}
		</script>
	</head>
	<body
		class={`${bodyStyle || ""} flex min-h-screen flex-col bg-[var(--bg-page)] text-[var(--text-main)]`}
	>
		<a
			href="#main-content"
			class="sr-only focus:not-sr-only focus:absolute focus:left-4 focus:top-4 focus:z-50 focus:rounded-md focus:bg-[var(--bg-elevated)] focus:px-3 focus:py-2"
		>
			Перейти к содержимому
		</a>
		<div class="w-full border-b border-[var(--border-soft)] bg-[var(--bg-surface)] py-3 text-center text-sm">
			<a
				href="https://t.me/+aXHt2loxo1RjZDcy"
				target="_blank"
				rel="noopener noreferrer"
				class="font-medium text-[var(--text-main)] underline underline-offset-4"
				>Проект независимого комитета "Действия"</a
			>
		</div>
		<Header />
		<Container class="py-10 md:py-14" id="main-content">
			<div class="flex flex-col gap-12">
				<slot />
			</div>
		</Container>
		<Footer />
		<PwaInstallBanner />
	</body>
</html>
